<!DOCTYPE html>
<html>
    <body>
        <a href="/test.html">Testing page</a>

        <script>//AUTOBAHN_DEBUG = true;</script>
        <script src="http://autobahn.s3.amazonaws.com/autobahnjs/latest/autobahn.min.jgz"></script>
        <script src="common-sound.js"></script>

        <script>
            var sound = null;
            var wsuri;

            if (document.location.origin == "file://") {
                wsuri = "ws://127.0.0.1:8080/ws";
            } else {
                wsuri = (document.location.protocol === "http:" ? "ws:" : "wss:") + "//" + document.location.host + "/ws";
            }

            var connection = new autobahn.Connection({
                url: wsuri,
                realm: "player"
            });

            function on_state_received(args) {
                var state = args[0];
                console.log(state);
            }

            // fired when connection is established and session attached
            connection.onopen = function (session, details) {
                sound = new CommonSound(session, on_state_received);
                console.log("Connected to router");
            };

            // fired when connection was lost (or could not be established)
            connection.onclose = function (reason, details) {
                cosole.log("Connection lost to router: " + reason);
            }

            connection.open();
        </script>
   </body>
</html>

